# 30 –∏–¥–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è JQ-Synth

## –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∏–¥–µ–π (–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)

### UX/CLI —É–ª—É—á—à–µ–Ω–∏—è (1-10)
1. –î–æ–±–∞–≤–∏—Ç—å live progress indicator —Å —ç–º–æ–¥–∑–∏ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –≤–æ –≤—Ä–µ–º—è synthesis
2. –£–ª—É—á—à–∏—Ç—å error messages —Å actionable –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –∏ —Ü–≤–µ—Ç–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
3. –î–æ–±–∞–≤–∏—Ç—å --list-tasks –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á –≤ –∫—Ä–∞—Å–∏–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
4. –î–æ–±–∞–≤–∏—Ç—å --explain —Ñ–ª–∞–≥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å fuzzy search –¥–ª—è task names (–Ω–∞–ø—Ä–∏–º–µ—Ä, "nested" –Ω–∞—Ö–æ–¥–∏—Ç "nested-field")
6. –î–æ–±–∞–≤–∏—Ç—å --dry-run —Ä–µ–∂–∏–º –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
7. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π --setup wizard –¥–ª—è –ø–µ—Ä–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
8. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å --history –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —É—Å–ø–µ—à–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
9. –î–æ–±–∞–≤–∏—Ç—å --validate-task –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ task —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
10. –î–æ–±–∞–≤–∏—Ç—å colorized output —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–≤–µ—Ç–∞–º–∏ –¥–ª—è –æ—à–∏–±–æ–∫/—É—Å–ø–µ—Ö–æ–≤/–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (11-15)
11. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ LLM –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ (—ç–∫–æ–Ω–æ–º–∏—è API –≤—ã–∑–æ–≤–æ–≤)
12. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏ --task all
13. Streaming API responses –¥–ª—è faster feedback (–≥–¥–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
14. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON –ø–µ—Ä–µ–¥ API –≤—ã–∑–æ–≤–æ–º (fail fast)
15. Batch API requests –¥–ª—è multiple tasks (—Å–Ω–∏–∂–µ–Ω–∏–µ latency)

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (16-20)
16. –î–æ–±–∞–≤–∏—Ç—å plugin system –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö reviewers/scorers
17. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ provider abstraction –¥–ª—è easier –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö LLM
18. –î–æ–±–∞–≤–∏—Ç—å telemetry/metrics collection (opt-in) –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
19. –ò–∑–≤–ª–µ—á—å prompt templates –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è easier tuning
20. –î–æ–±–∞–≤–∏—Ç—å configuration file (~/.jq-synth/config.yaml) –≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ env vars

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ (21-25)
21. –î–æ–±–∞–≤–∏—Ç—å --learn —Ä–µ–∂–∏–º, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è few-shot learning
22. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å multi-step synthesis –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π (decomposition)
23. –î–æ–±–∞–≤–∏—Ç—å --diff —Ä–µ–∂–∏–º –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–≤—É—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
24. –î–æ–±–∞–≤–∏—Ç—å export –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã (shell script, jq file, Python snippet)
25. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å --suggest –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏

### DevEx –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (26-28)
26. –î–æ–±–∞–≤–∏—Ç—å smoke test command (jq-synth --test) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ setup
27. –î–æ–±–∞–≤–∏—Ç—å benchmark suite –¥–ª—è regression testing –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
28. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å --mock —Ä–µ–∂–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö API calls

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å (29-30)
29. –î–æ–±–∞–≤–∏—Ç—å rate limiting –∏ exponential backoff –¥–ª—è API requests
30. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å sandboxed execution –¥–ª—è generated filters (security)

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞–∂–¥–æ–π –∏–¥–µ–∏

### ‚úÖ –ü–†–û–®–õ–ò –û–¢–ë–û–† (–±—É–¥—É—Ç –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω—ã):

**–ò–¥–µ—è #1: Live progress indicator**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è UX, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å print statements –≤ orchestrator
- Impact: HIGH - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç perceived performance

**–ò–¥–µ—è #2: –£–ª—É—á—à–µ–Ω–Ω—ã–µ error messages**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –æ–¥–Ω–∞ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º —Å–µ–π—á–∞—Å
- Effort: MEDIUM - —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ error handling –≤ cli.py
- Impact: HIGH - —Å–Ω–∏–∂–∞–µ—Ç friction –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏

**–ò–¥–µ—è #3: --list-tasks**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –æ—á–µ–≤–∏–¥–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ –ø–∞—Ä—Å–∏–Ω–≥ tasks.json –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç discoverability

**–ò–¥–µ—è #4: --explain —Ñ–ª–∞–≥**
- –û—Ü–µ–Ω–∫–∞: GOOD - –ø–æ–º–æ–≥–∞–µ—Ç –æ–±—É—á–µ–Ω–∏—é, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç LLM –≤—ã–∑–æ–≤ –∏–ª–∏ hardcoded logic
- Effort: MEDIUM-HIGH - –Ω—É–∂–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π LLM prompt –∏–ª–∏ parser
- Impact: MEDIUM - –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è core UX

**–ò–¥–µ—è #5: Fuzzy search –¥–ª—è task names**
- –û—Ü–µ–Ω–∫–∞: GOOD - nice to have, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- Effort: LOW - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å simple edit distance
- Impact: LOW - —Ä–µ–¥–∫–∏–π use case (–Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ –∑–∞–¥–∞—á)
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - low impact –¥–ª—è effort

**–ò–¥–µ—è #6: --dry-run —Ä–µ–∂–∏–º**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –≤–∞–∂–Ω–æ –¥–ª—è cost-conscious –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ skip executor.run() –∏ –ø–æ–∫–∞–∑–∞—Ç—å estimation
- Impact: MEDIUM - —Å–Ω–∏–∂–∞–µ—Ç anxiety about cost

**–ò–¥–µ—è #7: --setup wizard**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è first-time experience
- Effort: MEDIUM - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π input, –≤–∞–ª–∏–¥–∞—Ü–∏—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ config
- Impact: HIGH - —Å–Ω–∏–∂–∞–µ—Ç barrier to entry

**–ò–¥–µ—è #8: --history**
- –û—Ü–µ–Ω–∫–∞: GOOD - –ø–æ–ª–µ–∑–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç persistence layer
- Effort: MEDIUM-HIGH - –Ω—É–∂–Ω–∞ –ë–î –∏–ª–∏ file-based storage
- Impact: MEDIUM - nice to have, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê –¥–ª—è –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ - –¥–æ–±–∞–≤–ª—è–µ—Ç complexity

**–ò–¥–µ—è #9: --validate-task**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç waste of API calls
- Effort: LOW - schema validation + heuristics
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç developer experience

**–ò–¥–µ—è #10: Colorized output**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ CLI –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ü–≤–µ—Ç–∞
- Effort: LOW - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Ç–∏–ø–∞ colorama –∏–ª–∏ ANSI codes
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç readability –∏ UX

**–ò–¥–µ—è #11: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ LLM –æ—Ç–≤–µ—Ç–æ–≤**
- –û—Ü–µ–Ω–∫–∞: GOOD - —ç–∫–æ–Ω–æ–º–∏—Ç –¥–µ–Ω—å–≥–∏, –Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
- Effort: MEDIUM - hash prompts, file/db storage, expiration logic
- Impact: MEDIUM - –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è development, –º–µ–Ω—å—à–µ –¥–ª—è production
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - adds complexity, marginal benefit

**–ò–¥–µ—è #12: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –¥–ª—è --task all
- Effort: MEDIUM - asyncio –∏–ª–∏ ThreadPoolExecutor
- Impact: HIGH - 5x+ speedup –¥–ª—è batch mode

**–ò–¥–µ—è #13: Streaming API responses**
- –û—Ü–µ–Ω–∫–∞: GOOD - faster perceived performance
- Effort: HIGH - —Ç—Ä–µ–±—É–µ—Ç refactor provider layer –¥–ª—è streaming
- Impact: MEDIUM - marginal improvement –≤ latency
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–µ –æ–ø—Ä–∞–≤–¥–∞–Ω–∞ –¥–ª—è gains

**–ò–¥–µ—è #14: –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è JSON**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - fail fast, —ç–∫–æ–Ω–æ–º–∏—Ç API calls
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ json.loads() –ø–µ—Ä–µ–¥ generation
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç UX –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–≤–æ–¥–∞

**–ò–¥–µ—è #15: Batch API requests**
- –û—Ü–µ–Ω–∫–∞: POOR - OpenAI/Anthropic –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç batch –¥–ª—è chat
- Effort: N/A
- Impact: N/A
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç

**–ò–¥–µ—è #16: Plugin system**
- –û—Ü–µ–Ω–∫–∞: POOR - overengineering –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ scope
- Effort: HIGH
- Impact: LOW - –Ω–µ—Ç demand –¥–ª—è plugins —Å–µ–π—á–∞—Å
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - YAGNI

**–ò–¥–µ—è #17: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ provider abstraction**
- –û—Ü–µ–Ω–∫–∞: GOOD - –∫–æ–¥ —É–∂–µ —Ö–æ—Ä–æ—à, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
- Effort: MEDIUM
- Impact: LOW - internal quality, –Ω–µ user-facing
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - –∫–æ–¥ —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ö–æ—Ä–æ—à

**–ò–¥–µ—è #18: Telemetry collection**
- –û—Ü–µ–Ω–∫–∞: POOR - privacy concerns, –º–∞–ª–æ –ø–æ–ª—å–∑—ã –¥–ª—è small project
- Effort: MEDIUM
- Impact: LOW
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - –Ω–µ –Ω—É–∂–Ω–æ —Å–µ–π—á–∞—Å

**–ò–¥–µ—è #19: –ò–∑–≤–ª–µ—á—å prompts –≤ —Ñ–∞–π–ª—ã**
- –û—Ü–µ–Ω–∫–∞: GOOD - —É–ª—É—á—à–∞–µ—Ç maintainability
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ move strings to files
- Impact: LOW - —Ç–æ–ª—å–∫–æ –¥–ª—è maintainers
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - —Ç–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

**–ò–¥–µ—è #20: Configuration file**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - —É–¥–æ–±–Ω–µ–µ —á–µ–º env vars
- Effort: MEDIUM - YAML parsing, validation, merging —Å env vars
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç DX

**–ò–¥–µ—è #21: --learn —Ä–µ–∂–∏–º**
- –û—Ü–µ–Ω–∫–∞: GOOD - –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –Ω–æ —Å–ª–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- Effort: HIGH - —Ç—Ä–µ–±—É–µ—Ç ML –∏–ª–∏ heuristics
- Impact: MEDIUM - uncertain benefit
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - —Å–ª–∏—à–∫–æ–º experimental

**–ò–¥–µ—è #22: Multi-step synthesis**
- –û—Ü–µ–Ω–∫–∞: GOOD - –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è complex tasks, –Ω–æ —Å–ª–æ–∂–Ω–æ
- Effort: HIGH - orchestration logic
- Impact: MEDIUM - niche use case
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å

**–ò–¥–µ—è #23: --diff —Ä–µ–∂–∏–º**
- –û—Ü–µ–Ω–∫–∞: POOR - –æ—á–µ–Ω—å niche use case
- Effort: MEDIUM
- Impact: LOW
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - low value

**–ò–¥–µ—è #24: Export –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è integration
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç workflow integration

**–ò–¥–µ—è #25: --suggest –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∑–∞–¥–∞—á**
- –û—Ü–µ–Ω–∫–∞: GOOD - –ø–æ–º–æ–≥–∞–µ—Ç –Ω–æ–≤–∏—á–∫–∞–º, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç LLM call
- Effort: MEDIUM
- Impact: MEDIUM
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - nice to have, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ

**–ò–¥–µ—è #26: Smoke test command**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è debugging setup issues
- Effort: LOW - —É–∂–µ –µ—Å—Ç—å scripts/smoke_test.py, –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å
- Impact: MEDIUM - –ø–æ–º–æ–≥–∞–µ—Ç troubleshooting

**–ò–¥–µ—è #27: Benchmark suite**
- –û—Ü–µ–Ω–∫–∞: GOOD - –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è regression testing
- Effort: MEDIUM
- Impact: LOW - —Ç–æ–ª—å–∫–æ –¥–ª—è developers
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - —Ç–µ—Å—Ç—ã —É–∂–µ —Ö–æ—Ä–æ—à–∏

**–ò–¥–µ—è #28: --mock —Ä–µ–∂–∏–º**
- –û—Ü–µ–Ω–∫–∞: EXCELLENT - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è testing –∏ development
- Effort: LOW - –ø—Ä–æ—Å—Ç–æ return fixed responses
- Impact: MEDIUM - —É–ª—É—á—à–∞–µ—Ç testing experience

**–ò–¥–µ—è #29: Rate limiting**
- –û—Ü–µ–Ω–∫–∞: GOOD - –∑–∞—â–∏—Ç–∞ –æ—Ç exceeding quotas
- Effort: MEDIUM - tracking requests, delays
- Impact: LOW - —Ä–µ–¥–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - providers —É–∂–µ –∏–º–µ—é—Ç rate limits

**–ò–¥–µ—è #30: Sandboxed execution**
- –û—Ü–µ–Ω–∫–∞: GOOD - —É–∂–µ –µ—Å—Ç—å timeout/size limits, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è marginal
- Effort: HIGH - Docker/VM required
- Impact: LOW - jq —É–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–µ–Ω
- –†–µ—à–µ–Ω–∏–µ: –û–¢–ö–õ–û–ù–ï–ù–ê - —Ç–µ–∫—É—â–∞—è security –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞

---

## ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –°–ü–ò–°–û–ö –î–õ–Ø –ò–ú–ü–õ–ï–ú–ï–ù–¢–ê–¶–ò–ò

1. **Live progress indicator** (HIGH impact, LOW effort)
2. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ error messages** (HIGH impact, MEDIUM effort)
3. **--list-tasks –∫–æ–º–∞–Ω–¥–∞** (MEDIUM impact, LOW effort)
4. **--dry-run —Ä–µ–∂–∏–º** (MEDIUM impact, LOW effort)
5. **--setup wizard** (HIGH impact, MEDIUM effort)
6. **--validate-task –∫–æ–º–∞–Ω–¥–∞** (MEDIUM impact, LOW effort)
7. **Colorized output** (MEDIUM impact, LOW effort)
8. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á** (HIGH impact, MEDIUM effort)
9. **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è JSON –≤–∞–ª–∏–¥–∞—Ü–∏—è** (MEDIUM impact, LOW effort)
10. **Configuration file support** (MEDIUM impact, MEDIUM effort)
11. **Export –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã** (MEDIUM impact, LOW effort)
12. **Smoke test command** (MEDIUM impact, LOW effort)
13. **--mock —Ä–µ–∂–∏–º** (MEDIUM impact, LOW effort)

–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (impact/effort ratio):
1. Live progress indicator
2. Colorized output
3. --list-tasks
4. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è JSON –≤–∞–ª–∏–¥–∞—Ü–∏—è
5. –£–ª—É—á—à–µ–Ω–Ω—ã–µ error messages
6. --validate-task
7. --dry-run
8. Export –≤ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã
9. Smoke test command
10. --mock —Ä–µ–∂–∏–º
11. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
12. Configuration file
13. --setup wizard

---

## –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø–ª–∞–Ω—ã –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏

### ‚úÖ 1. Live Progress Indicator
**Confidence: 95%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–î–æ–±–∞–≤–∏—Ç—å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤–æ –≤—Ä–µ–º—è synthesis loop.

**–ö–æ–¥:**

```python
# src/orchestrator.py

def solve(self, task: Task, verbose: bool = False) -> Solution:
    logger.info("Starting solve for task '%s'", task.id)

    history: list[Attempt] = []
    best: Attempt | None = None
    stagnation_counter = 0
    seen_filters: set[str] = set()

    for iteration in range(1, self.max_iterations + 1):
        # NEW: Print progress
        if verbose or sys.stdout.isatty():
            print(f"\rIteration {iteration}/{self.max_iterations} ü§ñ Generating filter...",
                  end="", flush=True)

        try:
            filter_code = self.generator.generate(task, list(history) if history else None)
        except Exception as e:
            if verbose or sys.stdout.isatty():
                print(f"\r‚ùå Iteration {iteration}/{self.max_iterations} - Generation failed")
            # ... rest of error handling

        # NEW: Show testing progress
        if verbose or sys.stdout.isatty():
            print(f"\rIteration {iteration}/{self.max_iterations} ‚öôÔ∏è  Testing filter: {filter_code[:50]}...",
                  end="", flush=True)

        attempt = self.reviewer.review(task, filter_code, iteration)

        # NEW: Show score
        if verbose or sys.stdout.isatty():
            emoji = "‚úì" if attempt.aggregated_score == 1.0 else "üìä"
            print(f"\rIteration {iteration}/{self.max_iterations} {emoji} Score: {attempt.aggregated_score:.2f}")
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- Perceived performance —É–ª—É—á—à–∞–µ—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ actual –≤—Ä–µ–º—è —Ç–æ –∂–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–∏–º –≤ non-interactive mode (CI/CD)
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—è—Ç—å `sys.stdout.isatty()` –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å --quiet —Ñ–ª–∞–≥

---

### ‚úÖ 2. Colorized Output
**Confidence: 98%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–î–æ–±–∞–≤–∏—Ç—å —Ü–≤–µ—Ç–∞ –¥–ª—è –æ—à–∏–±–æ–∫ (–∫—Ä–∞—Å–Ω—ã–π), —É—Å–ø–µ—Ö–æ–≤ (–∑–µ–ª—ë–Ω—ã–π), –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–∂—ë–ª—Ç—ã–π).

**–ö–æ–¥:**

```python
# src/colors.py (NEW FILE)
"""
ANSI color codes for terminal output.
"""

import sys


class Colors:
    """ANSI color codes."""

    # Basic colors
    RED = '\033[91m'
    GREEN = '\033[92m'
    YELLOW = '\033[93m'
    BLUE = '\033[94m'
    MAGENTA = '\033[95m'
    CYAN = '\033[96m'

    # Styles
    BOLD = '\033[1m'
    DIM = '\033[2m'
    RESET = '\033[0m'

    @classmethod
    def disable(cls):
        """Disable all colors (for non-TTY or --no-color)."""
        cls.RED = ''
        cls.GREEN = ''
        cls.YELLOW = ''
        cls.BLUE = ''
        cls.MAGENTA = ''
        cls.CYAN = ''
        cls.BOLD = ''
        cls.DIM = ''
        cls.RESET = ''


def should_use_color() -> bool:
    """Check if colors should be used based on environment."""
    # Check NO_COLOR env var (https://no-color.org/)
    if os.environ.get('NO_COLOR'):
        return False

    # Check if stdout is a TTY
    if not sys.stdout.isatty():
        return False

    return True


# Initialize colors based on environment
if not should_use_color():
    Colors.disable()


def success(text: str) -> str:
    """Format text as success (green)."""
    return f"{Colors.GREEN}{text}{Colors.RESET}"


def error(text: str) -> str:
    """Format text as error (red)."""
    return f"{Colors.RED}{text}{Colors.RESET}"


def warning(text: str) -> str:
    """Format text as warning (yellow)."""
    return f"{Colors.YELLOW}{text}{Colors.RESET}"


def info(text: str) -> str:
    """Format text as info (blue)."""
    return f"{Colors.BLUE}{text}{Colors.RESET}"
```

```python
# src/cli.py - –æ–±–Ω–æ–≤–∏—Ç—å –≤—ã–≤–æ–¥

from src.colors import success, error, warning, info, Colors

def _print_solution(solution: Solution, verbose: bool = False) -> None:
    status = success("‚úì") if solution.success else error("‚úó")
    print(f"\n{status} Task: {Colors.BOLD}{solution.task_id}{Colors.RESET}")
    print(f"  Filter: {Colors.CYAN}{solution.best_filter}{Colors.RESET}")
    print(f"  Score: {_format_score(solution.best_score)}")
    print(f"  Iterations: {solution.iterations_used}")


def _format_score(score: float) -> str:
    """Format score with color based on value."""
    if score == 1.0:
        return success(f"{score:.3f}")
    elif score >= 0.8:
        return warning(f"{score:.3f}")
    else:
        return error(f"{score:.3f}")
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç readability
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–∏–¥–Ω–æ —É—Å–ø–µ—Ö–∏ vs –æ—à–∏–±–∫–∏
- –°–ª–µ–¥—É–µ—Ç NO_COLOR —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É

**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Å—Ç–∞—Ä—ã—Ö Windows terminals
- –†–µ—à–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è TTY –∏ NO_COLOR env var

---

### ‚úÖ 3. --list-tasks –∫–æ–º–∞–Ω–¥–∞
**Confidence: 100%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–¥–∞—á –≤ –∫—Ä–∞—Å–∏–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.

**–ö–æ–¥:**

```python
# src/cli.py

def _list_tasks(tasks: list[Task]) -> None:
    """
    Display all available tasks in a formatted table.

    Args:
        tasks: List of Task objects to display.
    """
    from src.colors import Colors, info, warning

    print(f"\n{Colors.BOLD}Available Tasks ({len(tasks)}){Colors.RESET}\n")

    # Group by difficulty (heuristic based on examples count and description)
    basic = []
    intermediate = []
    advanced = []

    for task in tasks:
        difficulty = _estimate_difficulty(task)
        if difficulty == "basic":
            basic.append(task)
        elif difficulty == "intermediate":
            intermediate.append(task)
        else:
            advanced.append(task)

    def print_group(name: str, tasks_list: list[Task]):
        if not tasks_list:
            return
        print(f"{Colors.BOLD}{name}{Colors.RESET} ({len(tasks_list)}):")
        for task in tasks_list:
            examples_text = f"{len(task.examples)} example" + ("s" if len(task.examples) != 1 else "")
            print(f"  ‚Ä¢ {Colors.CYAN}{task.id:<20}{Colors.RESET} {task.description[:60]}... ({examples_text})")
        print()

    print_group("Basic", basic)
    print_group("Intermediate", intermediate)
    print_group("Advanced", advanced)

    print(f"{Colors.DIM}Usage: jq-synth --task <task-id>{Colors.RESET}")
    print(f"{Colors.DIM}Run all: jq-synth --task all{Colors.RESET}\n")


def _estimate_difficulty(task: Task) -> str:
    """Estimate task difficulty based on heuristics."""
    # Simple heuristics
    desc_lower = task.description.lower()

    if any(word in desc_lower for word in ["group", "aggregate", "reduce", "sum all"]):
        return "advanced"
    elif any(word in desc_lower for word in ["filter", "select", "extract multiple"]):
        return "intermediate"
    else:
        return "basic"


# –í main():
parser.add_argument(
    "--list-tasks",
    action="store_true",
    help="List all available tasks and exit",
)

# –ü–æ—Å–ª–µ –ø–∞—Ä—Å–∏–Ω–≥–∞:
if parsed.list_tasks:
    try:
        all_tasks = load_tasks(parsed.tasks_file)
        _list_tasks(all_tasks)
        return 0
    except Exception as e:
        print(error(f"Error loading tasks: {e}"), file=sys.stderr)
        return 1
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –ö—Ä–∏—Ç–∏—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- –£–ª—É—á—à–∞–µ—Ç discoverable tasks
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å JSON —Ñ–∞–π–ª

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç (—ç—Ç–æ –æ—á–µ–≤–∏–¥–Ω–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å)

---

### ‚úÖ 4. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è JSON –≤–∞–ª–∏–¥–∞—Ü–∏—è
**Confidence: 100%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å JSON –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ LLM –¥–ª—è fail-fast.

**–ö–æ–¥:**

```python
# src/cli.py

def _validate_json_string(json_str: str, param_name: str) -> tuple[bool, str, Any]:
    """
    Validate a JSON string and provide helpful error messages.

    Args:
        json_str: The JSON string to validate.
        param_name: Name of the parameter (for error messages).

    Returns:
        Tuple of (is_valid, error_message, parsed_data).
    """
    try:
        data = json.loads(json_str)
        return True, "", data
    except json.JSONDecodeError as e:
        # Build helpful error message
        lines = json_str.split('\n')
        error_line = lines[e.lineno - 1] if e.lineno <= len(lines) else ""

        # Detect common issues
        suggestions = []
        if '{' in json_str and '}' not in json_str:
            suggestions.append("Missing closing brace }")
        if '[' in json_str and ']' not in json_str:
            suggestions.append("Missing closing bracket ]")
        if json_str.count('"') % 2 != 0:
            suggestions.append("Unmatched quote \"")
        if "'" in json_str and '"' not in json_str:
            suggestions.append("Use double quotes \" instead of single quotes '")

        msg = f"""
{error('Invalid JSON')} in --{param_name}

{error('Error:')} {e.msg}
{error('Position:')} Line {e.lineno}, Column {e.colno}

{error_line}
{' ' * (e.colno - 1)}^

Common issues:
"""
        for s in suggestions[:3]:  # Limit to 3 suggestions
            msg += f"  ‚Ä¢ {s}\n"

        msg += f"""
{info('Example of valid JSON:')}
  jq-synth -i '{{"x": 1}}' -o '1' -d 'Extract x'

{Colors.DIM}Tip: Use a JSON validator: https://jsonlint.com{Colors.RESET}
"""
        return False, msg, None


# –í main():
if is_interactive:
    # Interactive mode
    valid, err_msg, input_data = _validate_json_string(parsed.input, "input")
    if not valid:
        print(err_msg, file=sys.stderr)
        return 1

    valid, err_msg, output_data = _validate_json_string(parsed.output, "output")
    if not valid:
        print(err_msg, file=sys.stderr)
        return 1

    example = Example(input_data=input_data, expected_output=output_data)
    task = Task(id="interactive", description=parsed.desc, examples=[example])
    tasks = [task]
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –≠–∫–æ–Ω–æ–º–∏—Ç API calls –ø—Ä–∏ –æ–ø–µ—á–∞—Ç–∫–∞—Ö
- –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç error messages
- –ü–æ–º–æ–≥–∞–µ—Ç –Ω–æ–≤–∏—á–∫–∞–º

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ—Ç

---

### ‚úÖ 5. –£–ª—É—á—à–µ–Ω–Ω—ã–µ error messages
**Confidence: 90%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–£–ª—É—á—à–∏—Ç—å –≤—Å–µ error messages —Å actionable –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏.

**–ö–æ–¥:**

```python
# src/cli.py

def _format_jq_not_found_error() -> str:
    """Format helpful error message when jq binary is not found."""
    return f"""
{error('‚ö†Ô∏è  jq binary not found in your PATH')}

jq-synth requires the jq command-line tool to be installed.

{Colors.BOLD}Quick setup:{Colors.RESET}
  ‚Ä¢ macOS:    {info('brew install jq')}
  ‚Ä¢ Ubuntu:   {info('sudo apt-get install jq')}
  ‚Ä¢ Windows:  {info('choco install jq')}

{Colors.BOLD}After installation:{Colors.RESET}
  1. Verify: {Colors.CYAN}jq --version{Colors.RESET}
  2. Try again: {Colors.CYAN}jq-synth --help{Colors.RESET}

{Colors.DIM}Need help? https://stedolan.github.io/jq/download/{Colors.RESET}
"""


def _format_api_key_error(provider: str) -> str:
    """Format helpful error message when API key is missing."""
    if provider == "openai":
        return f"""
{error('üîë API key required')}

jq-synth uses AI to generate jq filters. You need an OpenAI API key.

{Colors.BOLD}Quick setup:{Colors.RESET}
  1. Sign up: {info('https://platform.openai.com')}
  2. Create key: {info('https://platform.openai.com/api-keys')}
  3. Set environment variable:
     {Colors.CYAN}export OPENAI_API_KEY='sk-...'{Colors.RESET}

{Colors.BOLD}Alternative providers:{Colors.RESET}
  ‚Ä¢ Anthropic: {Colors.CYAN}jq-synth --provider anthropic{Colors.RESET}
  ‚Ä¢ Local (Ollama): {Colors.CYAN}jq-synth --help-local{Colors.RESET}

{Colors.DIM}First time? Try: jq-synth --setup{Colors.RESET}
"""
    elif provider == "anthropic":
        return f"""
{error('üîë API key required')}

{Colors.BOLD}Anthropic API setup:{Colors.RESET}
  1. Sign up: {info('https://console.anthropic.com')}
  2. Create key: {info('https://console.anthropic.com/settings/keys')}
  3. Set environment variable:
     {Colors.CYAN}export ANTHROPIC_API_KEY='sk-ant-...'{Colors.RESET}

{Colors.DIM}Tip: OpenAI is the default provider: jq-synth --provider openai{Colors.RESET}
"""
    else:
        return f"{error('API key required')} for provider: {provider}"


def _format_task_not_found_error(task_id: str, available_tasks: list[Task]) -> str:
    """Format helpful error when task is not found."""
    from difflib import get_close_matches

    available_ids = [t.id for t in available_tasks]
    close_matches = get_close_matches(task_id, available_ids, n=1, cutoff=0.6)

    msg = f"\n{error('‚ö†Ô∏è  Task not found:')} {Colors.BOLD}{task_id}{Colors.RESET}\n"

    if close_matches:
        match = close_matches[0]
        matched_task = next(t for t in available_tasks if t.id == match)
        msg += f"\n{warning('Did you mean:')} {Colors.CYAN}{match}{Colors.RESET}\n"
        msg += f"{Colors.DIM}{matched_task.description}{Colors.RESET}\n"

    msg += f"\n{Colors.BOLD}Available tasks:{Colors.RESET}\n"
    for task in available_tasks[:5]:  # Show first 5
        msg += f"  ‚Ä¢ {Colors.CYAN}{task.id:<20}{Colors.RESET} {task.description[:50]}\n"

    if len(available_tasks) > 5:
        msg += f"\n{Colors.DIM}... and {len(available_tasks) - 5} more{Colors.RESET}\n"

    msg += f"\n{Colors.DIM}View all: jq-synth --list-tasks{Colors.RESET}\n"

    return msg


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ main():

try:
    executor = JQExecutor()
except RuntimeError as e:
    if "jq binary not found" in str(e):
        print(_format_jq_not_found_error(), file=sys.stderr)
    else:
        print(error(f"Error: {e}"), file=sys.stderr)
    return 1

try:
    generator = JQGenerator(...)
except ValueError as e:
    if "API key" in str(e) or "api_key" in str(e).lower():
        provider = parsed.provider or "openai"
        print(_format_api_key_error(provider), file=sys.stderr)
    else:
        print(error(f"Error: {e}"), file=sys.stderr)
    return 1

# Task not found:
tasks = [t for t in all_tasks if t.id == parsed.task]
if not tasks:
    print(_format_task_not_found_error(parsed.task, all_tasks), file=sys.stderr)
    return 1
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –ö—Ä–∏—Ç–∏—á–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ first-time experience
- –°–Ω–∏–∂–∞–µ—Ç support burden
- –°–ª–µ–¥—É–µ—Ç best practices (actionable errors)

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç maintenance –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ error paths
- –†–µ—à–µ–Ω–∏–µ: unit tests –¥–ª—è error scenarios

---

### ‚úÖ 6. --validate-task –∫–æ–º–∞–Ω–¥–∞
**Confidence: 85%**

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é task —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.

**–ö–æ–¥:**

```python
# src/task_validator.py (NEW FILE)
"""
Validation logic for task definitions.
"""

from dataclasses import dataclass
from typing import Any

from src.domain import Task


@dataclass
class ValidationWarning:
    """A validation warning for a task."""
    severity: str  # "info", "warning", "error"
    message: str
    suggestion: str


def validate_task(task: Task) -> list[ValidationWarning]:
    """
    Validate a task and return list of warnings/issues.

    Args:
        task: The task to validate.

    Returns:
        List of validation warnings.
    """
    warnings: list[ValidationWarning] = []

    # Check examples count
    if len(task.examples) < 2:
        warnings.append(ValidationWarning(
            severity="warning",
            message=f"Only {len(task.examples)} example provided (recommended: 3+)",
            suggestion="More examples improve accuracy and help AI understand the pattern"
        ))

    # Check if examples are too similar
    if len(task.examples) >= 2:
        inputs = [str(ex.input_data) for ex in task.examples]
        if len(set(inputs)) == 1:
            warnings.append(ValidationWarning(
                severity="warning",
                message="All examples have identical input",
                suggestion="Provide diverse examples to help AI generalize"
            ))

    # Check for very large inputs/outputs
    for i, example in enumerate(task.examples):
        input_size = len(str(example.input_data))
        output_size = len(str(example.expected_output))

        if input_size > 10000:  # 10KB
            warnings.append(ValidationWarning(
                severity="warning",
                message=f"Example {i+1}: Input is very large ({input_size/1024:.1f} KB)",
                suggestion="Large inputs may cause API timeouts. Consider simplifying."
            ))

        if output_size > 10000:
            warnings.append(ValidationWarning(
                severity="warning",
                message=f"Example {i+1}: Output is very large ({output_size/1024:.1f} KB)",
                suggestion="Large outputs may cause issues. Verify this is expected."
            ))

    # Check description quality
    if len(task.description) < 10:
        warnings.append(ValidationWarning(
            severity="info",
            message="Task description is very short",
            suggestion="More detailed descriptions help AI understand the goal"
        ))

    # Check for advanced jq patterns in description
    advanced_keywords = ["group_by", "reduce", "recurse", "walk", "min_by", "max_by"]
    if any(kw in task.description.lower() for kw in advanced_keywords):
        warnings.append(ValidationWarning(
            severity="info",
            message="Task description mentions advanced jq features",
            suggestion="These patterns may be challenging. Consider --max-iters 15"
        ))

    return warnings


def print_validation_warnings(warnings: list[ValidationWarning]) -> None:
    """Print validation warnings in a formatted way."""
    from src.colors import warning, info, error, Colors

    if not warnings:
        print(success("‚úì Task validation passed\n"))
        return

    print(f"\n{warning('‚ö†Ô∏è  Task validation warnings:')}\n")

    for i, w in enumerate(warnings, 1):
        if w.severity == "error":
            icon = error("‚úó")
        elif w.severity == "warning":
            icon = warning("‚ö†Ô∏è")
        else:
            icon = info("‚ÑπÔ∏è")

        print(f"{icon} {w.message}")
        print(f"   {Colors.DIM}‚Üí {w.suggestion}{Colors.RESET}\n")

    print(f"{Colors.DIM}Continue anyway? [y/N]: {Colors.RESET}", end="")
```

```python
# src/cli.py

parser.add_argument(
    "--validate-task",
    action="store_true",
    help="Validate task file and show warnings before running",
)

# –í main, –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º tasks:
if parsed.validate_task or (not is_interactive and len(tasks) > 0):
    from src.task_validator import validate_task, print_validation_warnings

    for task in tasks:
        warnings = validate_task(task)
        if warnings and parsed.validate_task:
            print(f"\n{Colors.BOLD}Validating task: {task.id}{Colors.RESET}")
            print_validation_warnings(warnings)

            # Ask for confirmation
            response = input().strip().lower()
            if response != 'y':
                print("Aborted.")
                return 1
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–æ:**
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç waste API calls –Ω–∞ –ø–ª–æ—Ö–∏—Ö –∑–∞–¥–∞—á–∞—Ö
- –û–±—É—á–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π best practices
- –≠–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è –∏ –¥–µ–Ω—å–≥–∏

**–ú–∏–Ω—É—Å—ã:**
- –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–∏–º –¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –†–µ—à–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ --validate-task –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å opt-out

---

–¢–µ–ø–µ—Ä—å –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä—É—é –¢–û–ü-5 –∏–¥–µ–π —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º impact/effort ratio:
1. Colorized output (EASIEST, HIGH IMPACT)
2. --list-tasks (EASY, MEDIUM-HIGH IMPACT)
3. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è JSON –≤–∞–ª–∏–¥–∞—Ü–∏—è (EASY, MEDIUM IMPACT)
4. Live progress indicator (EASY, HIGH IMPACT)
5. –£–ª—É—á—à–µ–Ω–Ω—ã–µ error messages (MEDIUM, HIGH IMPACT)
